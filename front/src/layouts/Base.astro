---
import AuthOverlay from '../components/AuthOverlay.astro';
import { SITE, SEO, generateJsonLd } from '../config/site';
import { DEFAULT_OGP } from '../lib/content';

interface Props {
    title?: string;
    description?: string;
}

const { title: propTitle, description: propDescription } = Astro.props;
const baseUrl = import.meta.env.BASE_URL;

// SSG化により、OGP情報はビルド時にデフォルト値を使用
// 動的なOGP更新が必要な場合は、別途対応が必要
const ogpTitle = propTitle || DEFAULT_OGP.title;
const ogpDescription = propDescription || DEFAULT_OGP.description;
const ogpImageUrl = `${baseUrl}images/ogp.webp`;
const jsonLd = generateJsonLd();
---

<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow">

    <title>{ogpTitle}</title>
    <meta name="description" content={ogpDescription}>
    <meta name="keywords" content={SEO.keywords.join(', ')}>
    <link rel="canonical" href={SITE.url}>

    <!-- OGP / Twitter Card -->
    <meta property="og:title" content={ogpTitle}>
    <meta property="og:description" content={ogpDescription}>
    <meta property="og:type" content="website">
    <meta property="og:locale" content={SITE.locale}>
    <meta property="og:url" content={SITE.url}>
    <meta property="og:image" content={ogpImageUrl}>
    <meta property="og:site_name" content={SITE.name}>
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content={ogpTitle}>
    <meta name="twitter:description" content={ogpDescription}>
    <meta name="twitter:image" content={ogpImageUrl}>

    <!-- JSON-LD -->
    <script type="application/ld+json" set:html={JSON.stringify(jsonLd)} />

    <!-- Favicon -->
    <link rel="icon" href={`${baseUrl}favicon/favicon.ico`} sizes="any">
    <link rel="icon" href={`${baseUrl}favicon/favicon.svg`} type="image/svg+xml">

    <!-- Hero画像のプリロード（モバイル回線対策） -->
    <link rel="preload" as="image" href={`${baseUrl}images/hero-main-sp.webp`} media="(max-width: 767px)">
    <link rel="preload" as="image" href={`${baseUrl}images/hero-main-pc.webp`} media="(min-width: 768px)">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&family=Zen+Kurenaido&display=swap" rel="stylesheet">

    <!-- Tailwind CSS は @astrojs/tailwind で統合 -->
</head>
<body>
    <!-- AuthOverlay は本番公開時に無効化 -->
    <!-- <AuthOverlay /> -->
    <slot />
</body>
</html>

<style is:global>
    @import '../styles/global.css';
</style>
